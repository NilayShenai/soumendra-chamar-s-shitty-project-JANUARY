{% extends "base.html" %}
{% block content %}
<section class="card narrow">
  <h1>{{ 'Edit payroll' if entry else 'Run payroll' }}</h1>
  <form class="stack" method="post">
    <label>Employee
      <select name="employee_id" required>
        {% for emp in employees %}
        <option value="{{ emp.id }}" {% if entry and entry.employee_id == emp.id %}selected{% endif %}>{{ emp.full_name() }}</option>
        {% endfor %}
      </select>
    </label>
    <div class="grid two">
      <label>Period start
        <input type="date" name="period_start" value="{{ entry.period_start if entry else '' }}" required>
      </label>
      <label>Period end
        <input type="date" name="period_end" value="{{ entry.period_end if entry else '' }}" required>
      </label>
    </div>
    <label>Pay date
      <input type="date" name="pay_date" value="{{ entry.pay_date if entry else '' }}" required>
    </label>
    <div class="grid two">
      <label>Gross pay (INR)
        <input type="number" step="0.01" name="gross_pay" value="{{ entry.gross_pay if entry else '' }}" required>
      </label>
      <label>Taxes (INR)
        <input type="number" step="0.01" name="taxes" value="{{ entry.taxes if entry else 0 }}">
      </label>
    </div>
    <label>Bonus (INR)
      <input type="number" step="0.01" name="bonus" value="{{ entry.bonus if entry else 0 }}">
    </label>
    <label>Status
      <select name="status">
        {% for status in ['scheduled','processing','paid'] %}
        <option value="{{ status }}" {% if entry and entry.status == status %}selected{% endif %}>{{ status }}</option>
        {% endfor %}
      </select>
    </label>
    <label>Notes
      <textarea name="notes" rows="3">{{ entry.notes if entry else '' }}</textarea>
    </label>
    <div class="actions">
      <a class="link-muted" href="{{ url_for('main.payroll_list') }}">Cancel</a>
      <button type="submit">Save</button>
    </div>
  </form>
</section>
{% endblock %}
